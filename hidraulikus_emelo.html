<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hidraulikus emel≈ë - DigiFAB</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            margin: 0;
            overflow-x: hidden;
            touch-action: none;
        }

        /* --- FEJL√âC √âS L√ÅBLEC ST√çLUSOK --- */
        .header {
            background-color: #2563eb;
            color: white;
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 50;
        }

        .header h1 { margin: 0; font-size: 1.25rem; font-weight: 700; display: flex; align-items: center; gap: 10px; }
        .header h1 span { font-weight: 900; opacity: 0.8; font-size: 0.9rem; }
        
        .badge { background-color: #1d4ed8; padding: 6px 16px; border-radius: 9999px; font-size: 0.8rem; font-weight: 700; }

        .footer {
            background-color: #0f172a;
            padding: 24px;
            color: white;
            font-size: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            opacity: 0.95;
            font-family: monospace;
            z-index: 50;
        }

        /* --- LAYOUT --- */
        .layout-wrapper {
            display: flex;
            flex-direction: column;
            height: calc(100vh - 60px - 60px); 
            flex: 1;
        }

        @media (min-width: 1024px) {
            .layout-wrapper { flex-direction: row; }
            .sidebar { width: 380px; min-width: 380px; border-left: 1px solid #e2e8f0; }
        }

        .canvas-area {
            flex: 1;
            position: relative;
            background-color: #ffffff;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .sidebar {
            background-color: white;
            overflow-y: auto;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            box-shadow: -4px 0 15px rgba(0,0,0,0.02);
        }

        /* --- UI ELEMEK --- */
        .measurement-card {
            background-color: #f8fafc;
            border-radius: 16px;
            padding: 16px;
            border: 1px solid #e2e8f0;
            border-left: 4px solid #2563eb;
        }

        .control-group label {
            display: block;
            font-size: 10px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #64748b;
            margin-bottom: 8px;
        }

        .math-text { font-family: "Times New Roman", Times, serif; font-style: italic; text-transform: none !important; }

        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            background: #e2e8f0;
            border-radius: 999px;
            outline: none;
            margin: 10px 0;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: #2563eb;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .input-box {
            background: #2563eb;
            color: white;
            padding: 4px 10px;
            border-radius: 8px;
            font-weight: 800;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .load-selector {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .load-btn {
            background: white;
            border: 1px solid #e2e8f0;
            padding: 12px 6px;
            border-radius: 12px;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .load-btn.active {
            background: #eff6ff;
            border-color: #2563eb;
            box-shadow: 0 4px 6px rgba(37, 99, 235, 0.1);
        }

        .load-btn span.emoji { font-size: 1.5rem; }
        .load-btn span.label { font-size: 10px; font-weight: 800; color: #64748b; }
        .load-btn.active span.label { color: #2563eb; }

        .btn-action {
            width: 100%;
            padding: 12px;
            background-color: #f1f5f9;
            border-radius: 12px;
            font-weight: 700;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .btn-action:hover { background-color: #e2e8f0; }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            font-size: 0.85rem;
            color: #475569;
        }
        .collapsible-content.open { max-height: 500px; padding: 10px 0; }

        .label-hint {
            position: absolute;
            top: 20px;
            background: rgba(37, 99, 235, 0.8);
            color: white;
            padding: 6px 16px;
            border-radius: 9999px;
            font-size: 11px;
            font-weight: 700;
            pointer-events: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            backdrop-blur: 4px;
        }

        .data-display-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 0;
            border-bottom: 1px solid #f1f5f9;
        }
        .data-display-row:last-child { border-bottom: none; }
    </style>
</head>
<body>

    <!-- FEJL√âC -->
    <div class="header">
        <div class="header-left">
            <h1><span>FIZIKA</span> ‚öñÔ∏è Hidraulikus emel≈ë</h1>
        </div>
        <div class="header-center font-black text-xl tracking-tighter opacity-80 hidden md:block">DigiFAB</div>
        <div class="header-right">
            <span class="badge">6. oszt√°ly</span>
        </div>
    </div>

    <div class="layout-wrapper">
        <!-- Szimul√°ci√≥s ter√ºlet -->
        <div class="canvas-area" id="canvas-container">
            <div class="label-hint">ADATOK MEGJELEN√çT√âS√âHEZ KATTINTS A RAJZRA</div>
            <canvas id="simCanvas"></canvas>
        </div>

        <!-- Vez√©rl≈ëpanel -->
        <div class="sidebar">
            
            <!-- ER≈ê BE√ÅLL√çT√ÅSA -->
            <div class="control-group">
                <label class="flex justify-between">
                    <span>Bemeneti er≈ë (<span class="math-text font-bold text-red-600">F‚ÇÅ</span>)</span>
                    <span class="input-box"><span id="f1-val-display">150</span> N</span>
                </label>
                <input type="range" id="f1-slider" min="0" max="1000" value="150">
            </div>

            <!-- DUGATTY√öK -->
            <div class="grid grid-cols-2 gap-4">
                <div class="control-group">
                    <label>Kis dugatty√∫ (<span class="math-text">T‚ÇÅ</span>)</label>
                    <div class="flex items-center gap-2">
                        <input type="range" id="t1-slider" min="5" max="30" value="10">
                        <span class="text-[10px] font-black w-12"><span id="t1-val-display">10</span> cm¬≤</span>
                    </div>
                </div>
                <div class="control-group">
                    <label>Nagy dugatty√∫ (<span class="math-text">T‚ÇÇ</span>)</label>
                    <div class="flex items-center gap-2">
                        <input type="range" id="t2-slider" min="30" max="200" value="100">
                        <span class="text-[10px] font-black w-12"><span id="t2-val-display">100</span> cm¬≤</span>
                    </div>
                </div>
            </div>

            <!-- M√âR√âSI EREDM√âNYEK -->
            <div class="control-group">
                <label>Kimeneti adatok</label>
                <div class="measurement-card space-y-2">
                    <div class="data-display-row">
                        <span class="text-[11px] font-bold text-slate-500 uppercase">Emel≈ëer≈ë (<span class="math-text text-emerald-600">F‚ÇÇ</span>)</span>
                        <span id="f2-display" class="font-black text-emerald-600 font-mono text-lg">0 N</span>
                    </div>
                    <div class="data-display-row">
                        <span class="text-[11px] font-bold text-slate-500 uppercase">S√∫lyer≈ë (<span class="math-text text-purple-600">F_g</span>)</span>
                        <span id="fg-display" class="font-black text-purple-600 font-mono text-lg">0 N</span>
                    </div>
                    <div id="lift-status" class="text-center text-[10px] font-black uppercase pt-2 tracking-widest">---</div>
                </div>
            </div>

            <!-- TEHER V√ÅLT√ÅSA -->
            <div class="control-group">
                <label>Teher v√°laszt√°sa</label>
                <div class="load-selector">
                    <button class="load-btn active" data-emoji="üöó" data-weight="1500">
                        <span class="emoji">üöó</span>
                        <span class="label">1500 N</span>
                    </button>
                    <button class="load-btn" data-emoji="üêò" data-weight="4500">
                        <span class="emoji">üêò</span>
                        <span class="label">4500 N</span>
                    </button>
                    <button class="load-btn" data-emoji="üéπ" data-weight="1000">
                        <span class="emoji">üéπ</span>
                        <span class="label">1000 N</span>
                    </button>
                    <button class="load-btn" data-emoji="üßä" data-weight="10">
                        <span class="emoji">üßä</span>
                        <span class="label">10 N</span>
                    </button>
                </div>
            </div>

            <!-- OPCI√ìK -->
            <div class="flex items-center justify-between p-3 bg-slate-50 rounded-xl border border-slate-200">
                <span class="text-xs font-bold text-slate-700 uppercase">S√∫lyer≈ë figyelembev√©tele</span>
                <input type="checkbox" id="weight-active" class="w-5 h-5 accent-blue-600 cursor-pointer">
            </div>

            <!-- SEG√âDLETEK -->
            <div class="space-y-2">
                <button class="btn-action" onclick="toggleSection('stats-panel', this)">
                    SZ√ÅM√çT√ÅSOK <i data-lucide="chevron-down" class="w-4 h-4"></i>
                </button>
                <div id="stats-panel" class="collapsible-content bg-slate-50 rounded-xl px-4">
                    <div class="py-2">
                        <div class="text-[10px] uppercase font-black text-slate-400 mb-1">Bels≈ë nyom√°s (p)</div>
                        <div class="bg-white border border-slate-200 p-3 rounded-lg text-center font-black text-blue-600 text-lg">
                            <span id="p-calc">0</span> Pa
                        </div>
                    </div>
                </div>

                <button class="btn-action" onclick="toggleSection('theory-panel', this)">
                    MAGYAR√ÅZAT <i data-lucide="chevron-down" class="w-4 h-4"></i>
                </button>
                <div id="theory-panel" class="collapsible-content text-xs leading-relaxed space-y-2">
                    <p><strong>Pascal t√∂rv√©nye:</strong> A nyom√°s a folyad√©kban minden ir√°nyban gyeng√≠tetlen√ºl terjed.</p>
                    <p><strong>Ar√°nyoss√°g:</strong> Min√©l nagyobb a dugatty√∫k fel√ºlet√©nek ar√°nya, ann√°l nagyobb er≈ët tudunk kifejteni.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- L√ÅBLEC -->
    <div class="footer">
        <span>Digit√°lis FABrik√°l√≥ M≈±hely</span>
        <span class="text-blue-500 font-black">.:henz:.</span>
        <span>Henzel Gy√∂rgy</span>
    </div>

    <script>
        lucide.createIcons();

        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const container = document.getElementById('canvas-container');

        const sliders = {
            f1: document.getElementById('f1-slider'),
            t1: document.getElementById('t1-slider'),
            t2: document.getElementById('t2-slider')
        };
        
        const displays = {
            f1: document.getElementById('f1-val-display'),
            t1: document.getElementById('t1-val-display'),
            t2: document.getElementById('t2-val-display'),
            p: document.getElementById('p-calc'),
            f2: document.getElementById('f2-display'),
            fg: document.getElementById('fg-display'),
            status: document.getElementById('lift-status')
        };

        const weightCheckbox = document.getElementById('weight-active');
        let currentLoad = "üöó";
        let currentLoadWeight = 1500;
        let showLabels = false;

        container.addEventListener('click', () => {
            showLabels = !showLabels;
            update();
        });

        function toggleSection(id, btn) {
            const panel = document.getElementById(id);
            const isOpen = panel.classList.toggle('open');
            const icon = btn.querySelector('svg');
            if (icon) {
                icon.style.transform = isOpen ? 'rotate(180deg)' : 'rotate(0deg)';
            }
        }

        function sync(type) {
            const val = sliders[type].value;
            displays[type].innerText = val;
            update();
        }

        Object.keys(sliders).forEach(key => {
            sliders[key].addEventListener('input', () => sync(key));
        });

        document.querySelectorAll('.load-btn').forEach(btn => {
            btn.onclick = () => {
                document.querySelectorAll('.load-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentLoad = btn.dataset.emoji;
                currentLoadWeight = parseFloat(btn.dataset.weight);
                update();
            };
        });

        weightCheckbox.addEventListener('change', update);

        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
        }

        function update() {
            const f1 = parseFloat(sliders.f1.value);
            const t1 = parseFloat(sliders.t1.value);
            const t2 = parseFloat(sliders.t2.value);
            
            const p = (f1 / t1) * 10000;
            const f2 = (f1 / t1) * t2;
            
            displays.p.innerText = formatNumber(Math.round(p));
            displays.f2.innerText = formatNumber(Math.round(f2)) + " N";
            displays.fg.innerText = formatNumber(Math.round(currentLoadWeight)) + " N";

            const travelScale = 140; 
            let h1 = 0, h2 = 0;
            const weightActive = weightCheckbox.checked;

            if (weightActive) {
                const f1_threshold = (currentLoadWeight / t2) * t1;
                if (f1 >= f1_threshold) {
                    const excess_f1 = f1 - f1_threshold;
                    const max_possible_excess = 1000 - f1_threshold;
                    h1 = (excess_f1 / Math.max(1, max_possible_excess)) * travelScale;
                    h2 = h1 * (t1 / t2);
                    displays.status.innerText = "Sikeres emel√©s! ‚úì";
                    displays.status.style.color = "#16a34a";
                } else {
                    h1 = 0; h2 = 0;
                    displays.status.innerText = `Kev√©s az er≈ë! (Hi√°ny: ${Math.ceil(f1_threshold - f1)} N)`;
                    displays.status.style.color = "#dc2626";
                }
            } else {
                h1 = (f1 / 1000) * travelScale;
                h2 = h1 * (t1 / t2);
                displays.status.innerText = "Demonstr√°ci√≥s m√≥d";
                displays.status.style.color = "#2563eb";
            }
            drawScene(h1, h2, t1, t2, f1, f2, p);
        }

        function drawScene(h1, h2, t1, t2, f1, f2, p) {
            const w = canvas.width, h = canvas.height;
            ctx.clearRect(0, 0, w, h);
            const bottomY = 400, pipeH = 50, startY = 220; 
            const scaleFactor = 1.8; 
            const w1 = t1 * scaleFactor, w2 = t2 * scaleFactor;
            const x1 = w * 0.25, x2 = w * 0.75;
            const y1 = startY + h1, y2 = startY - h2;

            // Tart√°ly √©s folyad√©k
            ctx.fillStyle = '#f1f5f9';
            ctx.beginPath();
            ctx.moveTo(x1 - w1/2, 50); ctx.lineTo(x1 - w1/2, bottomY);
            ctx.lineTo(x2 + w2/2, bottomY); ctx.lineTo(x2 + w2/2, 50);
            ctx.lineTo(x2 - w2/2, 50); ctx.lineTo(x2 - w2/2, bottomY - pipeH);
            ctx.lineTo(x1 + w1/2, bottomY - pipeH); ctx.lineTo(x1 + w1/2, 50);
            ctx.fill();

            ctx.fillStyle = '#3b82f6';
            ctx.beginPath();
            ctx.moveTo(x1 - w1/2, y1); ctx.lineTo(x1 - w1/2, bottomY);
            ctx.lineTo(x2 + w2/2, bottomY); ctx.lineTo(x2 + w2/2, y2);
            ctx.lineTo(x2 - w2/2, y2); ctx.lineTo(x2 - w2/2, bottomY - pipeH);
            ctx.lineTo(x1 + w1/2, bottomY - pipeH); ctx.lineTo(x1 + w1/2, y1);
            ctx.fill();

            ctx.strokeStyle = '#475569'; ctx.lineWidth = 3;
            ctx.beginPath(); ctx.moveTo(x1 - w1/2, 50); ctx.lineTo(x1 - w1/2, bottomY); ctx.lineTo(x2 + w2/2, bottomY); ctx.lineTo(x2 + w2/2, 50); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(x1 + w1/2, 50); ctx.lineTo(x1 + w1/2, bottomY - pipeH); ctx.lineTo(x2 - w2/2, bottomY - pipeH); ctx.lineTo(x2 - w2/2, 50); ctx.stroke();

            // Dugatty√∫k
            ctx.fillStyle = '#1e293b'; const pThick = 14;
            ctx.fillRect(x1 - w1/2 + 2, y1 - pThick, w1 - 4, pThick);
            ctx.fillRect(x2 - w2/2 + 2, y2 - pThick, w2 - 4, pThick);

            // Teher rajzol√°sa - Jelent≈ësebb s√ºllyeszt√©s (+12px), hogy biztosan √©rintkezzen
            const loadSize = Math.min(w2 * 0.8, 120);
            ctx.font = `${loadSize}px serif`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'bottom';
            ctx.fillText(currentLoad, x2, y2 - pThick + 12); 

            if (showLabels) {
                // ER≈êVEKTOROK: Vastagabb nyilak pontos t√°mad√°sponttal
                const vecThickness = 4.5; // Megn√∂velt vastags√°g
                const headSize = 10;      // Megn√∂velt ny√≠lfej
                
                // F1 (Piros) - Bemeneti er≈ë
                if (f1 > 0) {
                    const arrowLen1 = 15 + (f1 / 1000) * 50;
                    drawArrow(x1, y1 - pThick, x1, y1 - pThick + arrowLen1, '#ef4444', vecThickness, 'F‚ÇÅ', headSize);
                }
                
                // F2 (Z√∂ld) - Emel≈ëer≈ë
                if (f2 > 0) {
                    const arrowLen2 = 15 + Math.min(80, Math.sqrt(f2) * 2.5);
                    drawArrow(x2, y2 - pThick, x2, y2 - pThick - arrowLen2, '#16a34a', vecThickness, 'F‚ÇÇ', headSize);
                }

                // Fg (Lila) - S√∫lyer≈ë (eltolva oldalra)
                if (weightCheckbox.checked && currentLoadWeight > 0) {
                    const weightArrowLen = 15 + Math.min(60, Math.sqrt(currentLoadWeight) * 2);
                    const xOff = w2/3.5;
                    drawArrow(x2 + xOff, y2 - pThick, x2 + xOff, y2 - pThick + weightArrowLen, '#7b1fa2', vecThickness, 'Fg', headSize);
                }
                
                // Adat feliratok
                ctx.fillStyle = '#1e3a8a'; 
                ctx.font = 'bold 11px Inter';
                ctx.fillText(`T‚ÇÅ = ${t1} cm¬≤`, x1, bottomY + 20);
                ctx.fillText(`T‚ÇÇ = ${t2} cm¬≤`, x2, bottomY + 20);
                
                ctx.font = 'italic 10px Inter';
                ctx.fillStyle = '#475569';
                ctx.fillText(`Nyom√°s: ${formatNumber(Math.round(p))} Pa`, w/2, bottomY - 10);
            }
        }

        function drawArrow(fx, fy, tx, ty, color, weight, label, head) {
            const angle = Math.atan2(ty - fy, tx - fx);
            ctx.strokeStyle = color; ctx.fillStyle = color; ctx.lineWidth = weight;
            
            // Folytonos vonal
            ctx.beginPath(); ctx.moveTo(fx, fy); ctx.lineTo(tx, ty); ctx.stroke();
            
            // Ny√≠lfej
            ctx.beginPath(); ctx.moveTo(tx, ty);
            ctx.lineTo(tx - head * Math.cos(angle - Math.PI/6), ty - head * Math.sin(angle - Math.PI/6));
            ctx.lineTo(tx - head * Math.cos(angle + Math.PI/6), ty - head * Math.sin(angle + Math.PI/6));
            ctx.closePath(); ctx.fill();
            
            if (label) {
                ctx.font = 'bold 12px Inter'; // Megn√∂velt felirat m√©ret
                const offX = (fx === tx) ? 12 : (fx > tx ? -15 : 15);
                const offY = (fy === ty) ? 0 : (fy > ty ? -4 : 10);
                ctx.fillText(label, tx + offX, ty + offY);
            }
        }

        function resize() {
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
            update();
        }

        window.onresize = resize;
        window.onload = resize;
    </script>
</body>
<button onclick="location.href='index.html'" style="
    position: fixed; 
    top: 10px; 
    right: 140px; 
    padding: 10px 10px; 
    background: #FFF3eb; 
    color: green; 
    border: none; 
    border-radius: 8px; 
    cursor: pointer; 
    z-index: 1000;
    box-shadow: 0 2px 5px rgba(2,2,2,0.2);
">üè†</button>
</html>